<!-- steps/step1-info/step1-info.component.html -->

<c-card>
  <c-card-header>
    <strong>
      <c-icon name="cilInfo" class="me-2"></c-icon>
      Información General del Parqueo
    </strong>
  </c-card-header>

  <c-card-body>

    <!-- ERROR -->
    @if (errorMessage) {
      <c-alert color="danger" [dismissible]="true">
        <c-icon name="cilWarning" class="me-2"></c-icon>{{ errorMessage }}
      </c-alert>
    }

    <form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>

      <!-- FILA 1: Nombre + Código -->
      <div cRow class="mb-3">
        <div cCol sm="8">
          <label cLabel for="name">Nombre del Parqueo <span class="text-danger">*</span></label>
          <input
            cFormControl
            id="name"
            type="text"
            formControlName="name"
            placeholder="Ej: Parqueo Simón Bolívar"
            [class.is-invalid]="isInvalid('name')"
          />
          @if (isInvalid('name')) {
            <c-form-feedback [valid]="false">{{ getError('name') }}</c-form-feedback>
          }
        </div>

        <div cCol sm="4">
          <label cLabel for="code">Código <span class="text-danger">*</span></label>
          <input
            cFormControl
            id="code"
            type="text"
            formControlName="code"
            placeholder="Ej: PSB"
            (input)="onCodeInput($event)"
            [class.is-invalid]="isInvalid('code')"
          />
          @if (isInvalid('code')) {
            <c-form-feedback [valid]="false">{{ getError('code') }}</c-form-feedback>
          }
          <div class="form-text">Solo mayúsculas, números y guiones.</div>
        </div>
      </div>

      <!-- FILA 2: Dirección -->
      <div cRow class="mb-3">
        <div cCol sm="12">
          <label cLabel for="address">Dirección <span class="text-danger">*</span></label>
          <input
            cFormControl
            id="address"
            type="text"
            formControlName="address"
            placeholder="Ej: Distrito de Huaraz, Ancash"
            [class.is-invalid]="isInvalid('address')"
          />
          @if (isInvalid('address')) {
            <c-form-feedback [valid]="false">{{ getError('address') }}</c-form-feedback>
          }
        </div>
      </div>

      <!-- FILA 3: Descripción -->
      <div cRow class="mb-3">
        <div cCol sm="12">
          <label cLabel for="description">Descripción</label>
          <textarea
            cFormControl
            id="description"
            formControlName="description"
            rows="3"
            placeholder="Descripción general del parqueo (opcional)"
            [class.is-invalid]="isInvalid('description')"
          ></textarea>
          @if (isInvalid('description')) {
            <c-form-feedback [valid]="false">{{ getError('description') }}</c-form-feedback>
          }
        </div>
      </div>

      <!-- FILA 4: Coordenadas GPS -->
      <div cRow class="mb-3">
        <div cCol sm="6">
          <label cLabel for="latitude">Latitud GPS</label>
          <input
            cFormControl
            id="latitude"
            type="number"
            formControlName="latitude"
            placeholder="Ej: -9.5277"
            step="0.0001"
            [class.is-invalid]="isInvalid('latitude')"
          />
          @if (isInvalid('latitude')) {
            <c-form-feedback [valid]="false">{{ getError('latitude') }}</c-form-feedback>
          }
          <div class="form-text">Rango: -90 a 90</div>
        </div>

        <div cCol sm="6">
          <label cLabel for="longitude">Longitud GPS</label>
          <input
            cFormControl
            id="longitude"
            type="number"
            formControlName="longitude"
            placeholder="Ej: -77.5278"
            step="0.0001"
            [class.is-invalid]="isInvalid('longitude')"
          />
          @if (isInvalid('longitude')) {
            <c-form-feedback [valid]="false">{{ getError('longitude') }}</c-form-feedback>
          }
          <div class="form-text">Rango: -180 a 180</div>
        </div>
      </div>

    </form>
  </c-card-body>

  <!-- FOOTER CON BOTÓN -->
  <c-card-footer class="d-flex justify-content-end">
    <button
      cButton
      color="primary"
      [disabled]="loading"
      (click)="onSubmit()">
      @if (loading) {
        <span class="spinner-border spinner-border-sm me-2"></span>
        Guardando...
      } @else {
        <c-icon name="cilArrowRight" class="me-2"></c-icon>
        Siguiente: Zonas
      }
    </button>
  </c-card-footer>
</c-card>